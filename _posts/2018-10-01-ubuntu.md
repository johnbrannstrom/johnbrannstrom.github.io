---
layout: page-fullwidth
header:
  image_fullwidth: john-screen-header.gif
title: "Ubuntu administration"
teaser: "Lazy dog and short guides for working with a Ubuntu system."
tags:
  - Linux system administration
#
# Styling
#
image:
  header: ""
  thumb: "ubuntu-thumb.jpg"
  homepage: ""
  url: "https://johnbrannstrom.github.io/images/"
---

<h3>Set web proxy for package management tool (apt)</h3>
<pre>echo 'Acquire::http::Proxy "http://&lt;proxy server&gt;:&lt;port&gt;/";' &gt; /etc/apt/apt.conf.d/proxy.conf</pre>

<h3>Add universe repo in Ubuntu 18.04</h3>
<pre>sed -i 's/bionic main/bionic main universe/g' /etc/apt/sources.list && sed -i 's/bionic-security main/bionic-security main universe/g' /etc/apt/sources.list && sed -i 's/bionic-updates main/bionic-updates main universe/g' /etc/apt/sources.list && apt-get update</pre>

<h3>Docker DNS problem in Ubuntu 18.04</h3>
There is a problem with DNS and Docker containers in Ubuntu 18.04. This can be adressed by doing the following:
<pre>mv /etc/resolv.conf /etc/resolv.conf.bak && ln -s /run/systemd/resolve/resolve.conf /etc/resolv.conf</pre>

<h3>Change machine-id in Ubuntu 18.04</h3>
This will among other solve the problem of two VM:s getting the same IP when they are cloned.
<pre>rm -f /etc/machine-id
dbus-uuidgen --ensure=/etc/machine-id
rm /var/lib/dbus/machine-id
dbus-uuidgen --ensure
shutdown -r now</pre>

<h3>Change hostname in Ubuntu 18.04</h3>
<pre>hostnamectl set-hostname &lt;hostname&gt;
sed -i 's/preserve_hostname: *false/preserve_hostname: true/' /etc/cloud/cloud.cfg
hostnamectl</pre>

<h3>Change hostname in Ubuntu 18.04</h3>
<pre>hostnamectl set-hostname &lt;hostname&gt;
sed -i 's/preserve_hostname: *false/preserve_hostname: true/' /etc/cloud/cloud.cfg
hostnamectl</pre>

<h3>Set default user for Windows subsystem for linux</h3>
The following command should be run from a Windows cmd prompt:
<pre>ubuntu1804 config --default-user root</pre>
